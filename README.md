# Finance-and-Sales-Analytics_SQL

- AtliQ is a fast-growing hardware company that sells various products to customers in many countries through various channels, including retail, direct sales, and distributor networks, both online and in brick-and-mortar stores.
-  To understand the business and boost sales of the company, AtliQ needs clear insights into it's data to make informed decision-making strategies.
-  This project involves anlysing over 1.5 million sales records in SQL

## Client Requirements
Generate a report of individual product sales(aggregated on a monthly basis at the product level) for Amazon India customers for FY=2021 so that I track individual individual product sales.

### Financial Report

1. Month

2. Product Name & Variants

3. Sold Quantity

4. Gross Price per Item

5. Gross Price Total

### Sales Report

1. Top Markets

2. Top Product

3. Top Customers

**Here, I have provided the link to the document containing a detailed step-by-step analysis that led to meeting the requirements, along with a snapshot for reference.**

### Generated Reports

#### [1. Gross Sales Report : MONTHLY PRODUCT TRANSACTIONS](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/blob/main/Gross%20Sales%20Report-Monthly%20Product%20Transactions.pdf)



```
SELECT 
    	    s.date, 
            s.product_code, 
            p.product, 
            p.variant, 
            s.sold_quantity, 
            g.gross_price,
            ROUND(s.sold_quantity*g.gross_price,2) as gross_price_total
	FROM fact_sales_monthly s
	JOIN dim_product p
            ON s.product_code=p.product_code
	JOIN fact_gross_price g
            ON g.fiscal_year=get_fiscal_year(s.date)
    	AND g.product_code=s.product_code
	WHERE 
    	    customer_code=90002002 AND 
            get_fiscal_year(s.date)=2021     
	LIMIT 1000000;
```

Query Result:

![Screenshot 2024-05-12 at 11 41 02 PM](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/assets/135410984/e8bd314d-9d87-44e8-b82b-36a806e18358)


#### [2.Gross Sales Report:TOTAL SALES AMOUNT](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/blob/main/Gross%20Sales%20Report-TOTAL%20SALES%20AMOUNT.pdf)


```
select c.market,sum(sold_quantity) as sold_amount
from fact_sales_monthly s
join dim_customer c
on s.customer_code = c.customer_code
where get_fiscal_year(s.date)=2021 and c.market="India"
group by c.market;
```
![Screenshot 2024-05-13 at 12 19 45 PM](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/assets/135410984/e5d25462-e283-4c9f-b25f-9f2697cacf12)

####  [3. Pre Invoice & Post Invoice Amount with MONTHLY NET SALES](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/blob/main/Monthly%20Gross%20Sales%20Report.pdf)

**Generated by implementing Views**

**Pre Invoice**


![Screenshot 2024-05-13 at 1 15 10 PM](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/assets/135410984/2acb1513-66ba-4583-87c3-e339a67769cd)





**Post-Invoice**


![Screenshot 2024-05-13 at 1 16 55 PM](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/assets/135410984/4fa3fa39-7dd6-4095-885e-6e35ab5fc096)



**Final Insight**

	SELECT
 
            *, 
	    
    	    net_invoice_sales*(1-post_invoice_discount_pct) as net_sales
	 
	FROM gdb0041.sales_postinv_discount;


 
![Screenshot 2024-05-13 at 1 19 35 PM](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/assets/135410984/e00a2778-45d4-413a-b8c5-f75309a06493)



####  [4. Top MARKET](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/blob/main/Top%20MARKET.pdf)


```

## Retrieve the top 2 markets in every region by their gross sales amount in FY=2021.
with cte1 as (
		select
			c.market,
			c.region,
			round(sum(sold_quantity)/1000000,2) as gross_sales_mln
			from fact_sales_monthly s
			join dim_customer c
			on c.customer_code=s.customer_code
			where fiscal_year=2021
			group by market,region
			order by gross_sales_mln desc
		),
		cte2 as (
			select *,
			dense_rank() over(partition by region order by gross_sales_mln desc) as drnk
			from cte1
		)
	select * from cte2 where drnk<=2;
```

![Screenshot 2024-05-13 at 3 11 08 PM](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/assets/135410984/0d85f74a-5eac-4b4f-b998-35a56afffc92)


####  [4. Top PRODUCTS](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/blob/main/Top%20PRODUCTS.pdf)

```
with cte1 as 
		(select
                     p.division,
                     p.product,
                     sum(sold_quantity) as total_qty
                from fact_sales_monthly s
                join dim_product p
                      on p.product_code=s.product_code
                where fiscal_year=2021
                group by p.product,p.division),
           cte2 as 
	        (select 
                     *,
                     dense_rank() over (partition by division order by total_qty desc) as drnk
                from cte1)
	select * from cte2 where drnk<=3
```
![Screenshot 2024-05-13 at 3 08 44 PM](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/assets/135410984/00055121-ce79-4666-b6b9-b76b7659edbc)

####  [5. Top CUSTOMERS](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/blob/main/Top%20CUSTOMERS.pdf)

Stored procedure that takes market, fiscal_year and top n as an input and returns top n customers by net sales in that given fiscal year and market

![Screenshot 2024-05-13 at 3 00 13 PM](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/assets/135410984/65e393e9-d315-4af3-8367-f017233f8f0f)


**Top 5 Customer in market fiscal year 2021**

![Screenshot 2024-05-13 at 2 54 53 PM](https://github.com/sushmitafordata/Finance-and-Sales-Analytics_SQL/assets/135410984/ac8977d1-412b-4144-af94-1ffb147465dd)

### Skills utilised for the Project
1. Data Modelling and ETL
2. Joins and Analystics on Tables
3. Subqueries and co-related Subquery
4. Common Table Expression(CTE)
5. Database Normalization and Integrity
6. Entity Relationship Diagram(ERD)
7. User Defined SQL Function
8. Stored Procedures
9. Database Views
10. Performance Improvement
11. Windows Function:OVER, ROW_NUMBER, RANK, DENSE_RANK

























 



